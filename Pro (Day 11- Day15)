----------Lesson 11----------



--OVER PARTITION BY



SELECT
*,
SUM(amount) OVER(PARTITION BY customer_id)
FROM payment

SELECT
*,
SUM(amount) OVER(PARTITION BY customer_id)
FROM payment
ORDER BY 1

SELECT
*,
COUNT(*) OVER(PARTITION BY customer_id)
FROM payment
ORDER BY 1

SELECT
*,
COUNT(*) OVER(PARTITION BY customer_id,staff_id)
FROM payment
ORDER BY 1

SELECT
*,
COUNT(*) OVER()
FROM payment
ORDER BY 1

SELECT
*,
ROUND(AVG(amount) OVER(),2)
FROM payment
ORDER BY 1

--Challenge 1
SELECT f.film_id, title, length as length_of_movie, name as category, 
ROUND(AVG(length) OVER(PARTITION BY name),2) FROM film f
LEFT JOIN film_category fc
ON f.film_id = fc.film_id
LEFT JOIN category c
ON c.category_id = fc.category_id
ORDER BY film_id
