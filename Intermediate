--LENGTH
--LOWER, UPPER
SELECT 
UPPER (email) AS email_upper,
LOWER (email) AS email_lower,
email
FROM customer

SELECT 
LOWER (email) AS email_lower,
email,
LENGTH(email)
FROM customer
WHERE LENGTH(email) < 30

-- Challenge 1
SELECT 
LOWER(first_name),
LOWER(last_name),
LOWER(email)
FROM customer
WHERE LENGTH(first_name) > 10 
OR LENGTH(last_name) > 10

--LEFT,RIGHT
SELECT
LEFT(first_name, 2),
first_name
FROM customer

--to get second letter
SELECT
RIGHT(LEFT(first_name, 2), 1),
first_name
FROM customer

--Challenge 2.1
SELECT
RIGHT(email, 5)
FROM customer

--Challenge 2.2
SELECT
LEFT(RIGHT(email, 4),1)
FROM customer

--Concatenate
SELECT
LEFT (first_name,1)|| LEFT(last_name,1)
FROM customer

SELECT
LEFT (first_name,1)||'.'||LEFT(last_name,1)||'.' AS initials,
first_name,
last_name
FROM customer

--Challenge 3
SELECT
email, LEFT(email,1)||'***'||RIGHT(email,19)
FROM customer

--POSITION
SELECT
POSITION('@' IN email),
email
FROM customer

SELECT
LEFT(email, POSITION('@' IN email)-1),
email
FROM customer

SELECT
LEFT(email, POSITION(last_name IN email)-2),
email
FROM customer

--Challenge 4
SELECT
last_name||','||LEFT(email, POSITION(last_name in email)-2)
FROM customer

--Challenge 4(2)
SELECT
last_name||','||LEFT(email,POSITION('.' IN email)-1)
FROM customer

--SUBSTRING
SELECT
email,
SUBSTRING (email from POSITION('.' in email)+1 for 3)
FROM customer

SELECT
email,
SUBSTRING (email from POSITION('.' in email)+1 for LENGTH(last_name))
FROM customer

SELECT
email,
SUBSTRING (email from 3 for 2)
FROM customer

SELECT
email,
SUBSTRING (email from POSITION('.' in email)+1 for POSITION ('@' in email)-POSITION('.' in email)-1)
FROM customer

--Challenge 5.1
SELECT
LEFT(email,1)||'***'
||SUBSTRING(email from POSITION('.' in email)+1 for 1 )||'***'
||SUBSTRING(email from POSITION('@' in email)),
email
FROM customer

--Challenge 5.2
SELECT
'***'
||SUBSTRING(email from POSITION('.' in email)-1 for 3 )
||'***'
||SUBSTRING(email from POSITION('@' in email)),
email
FROM customer


