--LENGTH
--LOWER, UPPER
SELECT 
UPPER (email) AS email_upper,
LOWER (email) AS email_lower,
email
FROM customer

SELECT 
LOWER (email) AS email_lower,
email,
LENGTH(email)
FROM customer
WHERE LENGTH(email) < 30

-- Challenge 1
SELECT 
LOWER(first_name),
LOWER(last_name),
LOWER(email)
FROM customer
WHERE LENGTH(first_name) > 10 
OR LENGTH(last_name) > 10

--LEFT,RIGHT
SELECT
LEFT(first_name, 2),
first_name
FROM customer

--to get second letter
SELECT
RIGHT(LEFT(first_name, 2), 1),
first_name
FROM customer

--Challenge 2.1
SELECT
RIGHT(email, 5)
FROM customer

--Challenge 2.2
SELECT
LEFT(RIGHT(email, 4),1)
FROM customer

--Concatenate
SELECT
LEFT (first_name,1)|| LEFT(last_name,1)
FROM customer

SELECT
LEFT (first_name,1)||'.'||LEFT(last_name,1)||'.' AS initials,
first_name,
last_name
FROM customer

--Challenge 3
SELECT
email, LEFT(email,1)||'***'||RIGHT(email,19)
FROM customer

--POSITION
SELECT
POSITION('@' IN email),
email
FROM customer

SELECT
LEFT(email, POSITION('@' IN email)-1),
email
FROM customer

SELECT
LEFT(email, POSITION(last_name IN email)-2),
email
FROM customer

--Challenge 4
SELECT
last_name||','||LEFT(email, POSITION(last_name in email)-2)
FROM customer

--Challenge 4(2)
SELECT
last_name||','||LEFT(email,POSITION('.' IN email)-1)
FROM customer

--SUBSTRING
SELECT
email,
SUBSTRING (email from POSITION('.' in email)+1 for 3)
FROM customer

SELECT
email,
SUBSTRING (email from POSITION('.' in email)+1 for LENGTH(last_name))
FROM customer

SELECT
email,
SUBSTRING (email from 3 for 2)
FROM customer

SELECT
email,
SUBSTRING (email from POSITION('.' in email)+1 for POSITION ('@' in email)-POSITION('.' in email)-1)
FROM customer

--Challenge 5.1
SELECT
LEFT(email,1)||'***'
||SUBSTRING(email from POSITION('.' in email)+1 for 1 )||'***'
||SUBSTRING(email from POSITION('@' in email)),
email
FROM customer

--Challenge 5.2
SELECT
'***'
||SUBSTRING(email from POSITION('.' in email)-1 for 3 )
||'***'
||SUBSTRING(email from POSITION('@' in email)),
email
FROM customer

--EXTRACT

SELECT
EXTRACT(day from rental_date),
COUNT(*)
FROM rental
GROUP BY EXTRACT(day from rental_date)
ORDER BY COUNT(*) DESC

SELECT
EXTRACT(month from rental_date),
COUNT(*)
FROM rental
GROUP BY EXTRACT(month from rental_date)
ORDER BY COUNT(*) DESC

--Challenge 6.1
SELECT
EXTRACT(month from payment_date) AS month,
SUM(amount) AS total_payment_amount
FROM payment
GROUP BY month
ORDER BY SUM(amount) DESC

--Challenge 6.2
SELECT
EXTRACT(dow from payment_date) AS day_of_week,
SUM(amount) AS total_payment_amount
FROM payment
GROUP BY day_of_week
ORDER BY SUM(amount) DESC

--Challenge 6.3
SELECT
EXTRACT(week from payment_date) AS week,
customer_id,
SUM(amount) AS total_payment_amount
FROM payment
GROUP BY week,customer_id
ORDER BY SUM(amount) DESC

--TO-CHAR
SELECT
*,
EXTRACT(month from payment_date),
TO_CHAR(payment_date, 'MM-YYYY')
FROM payment

SELECT
*,
EXTRACT(month from payment_date),
TO_CHAR(payment_date, 'YY/')
FROM payment

SELECT
*,
EXTRACT(month from payment_date),
TO_CHAR(payment_date, 'Day Month YYYY')
FROM payment


SELECT
SUM(amount),
TO_CHAR(payment_date, 'Day Month YYYY')
FROM payment
GROUP BY TO_CHAR(payment_date, 'Day Month YYYY')

SELECT
SUM(amount),
TO_CHAR(payment_date, 'Day, Month YYYY')
FROM payment
GROUP BY TO_CHAR(payment_date, 'Day, Month YYYY')

SELECT
SUM(amount),
TO_CHAR(payment_date, 'Dy, Month YYYY')
FROM payment
GROUP BY TO_CHAR(payment_date, 'Dy, Month YYYY')

--Challenge 7.1
SELECT
SUM(amount) AS total_amount,
TO_CHAR(payment_date, 'Dy, DD/MM/YYYY') AS day
FROM payment
GROUP BY day
ORDER BY SUM(amount)

--Challenge 7.2
SELECT
SUM(amount) AS total_amount,
TO_CHAR(payment_date, 'Mon,YYYY') AS mon_year
FROM payment
GROUP BY mon_year
ORDER BY SUM(amount)

--Challenge 7.3
SELECT
SUM(amount) AS total_amount,
TO_CHAR(payment_date, 'Dy,HH:MI') AS day_time
FROM payment
GROUP BY day_time
ORDER BY SUM(amount) DESC

--Interval & Timestamps

SELECT CURRENT_DATE

SELECT CURRENT_TIMESTAMP

SELECT CURRENT_TIMESTAMP,
rental_date
FROM rental

SELECT CURRENT_DATE,
rental_date
FROM rental

SELECT CURRENT_TIMESTAMP,
CURRENT_TIMESTAMP-rental_date
FROM rental

SELECT CURRENT_TIMESTAMP,
return_date-rental_date
FROM rental


SELECT CURRENT_TIMESTAMP,
EXTRACT(day from return_date-rental_date)
FROM rental

SELECT CURRENT_TIMESTAMP,
EXTRACT(hour from return_date-rental_date)
FROM rental

SELECT CURRENT_TIMESTAMP,
EXTRACT(day from return_date-rental_date)*24
FROM rental

SELECT CURRENT_TIMESTAMP,
EXTRACT(day from return_date-rental_date)*24
+EXTRACT(hour from return_date-rental_date)
FROM rental

SELECT CURRENT_TIMESTAMP,
EXTRACT(day from return_date-rental_date)*24
+EXTRACT(hour from return_date-rental_date) || ' hours'
FROM rental


SELECT CURRENT_TIMESTAMP,
TO_CHAR(return_date-rental_date, 'DD')
FROM rental

SELECT CURRENT_TIMESTAMP,
TO_CHAR(return_date-rental_date, 'MI')
FROM rental

--Challenge 8.1
SELECT
rental_id,
return_date-rental_date AS rental_duration
FROM rental
WHERE customer_id = 35

--Challenge 8.2
SELECT
customer_id,
AVG(return_date-rental_date) AS rental_duration
FROM rental
GROUP BY customer_id
ORDER BY rental_duration DESC 

----------Day 5------------
--Mathematical functions and operations
